{{define "base"}}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>JSON Formatter</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body class="bg-slate-50">
  <main class="container py-4">
    {{template "content" .}}
  </main>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script>
    (() => {
      const body = document.body;
      const toggleBtnId = 'themeToggle';
      const sun = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8 3.5a.5.5 0 0 1 .5-.5h0a.5.5 0 0 1 0 1h0A.5.5 0 0 1 8 3.5m0 8a.5.5 0 0 1 .5-.5h0a.5.5 0 0 1 0 1h0A.5.5 0 0 1 8 11.5m4.5-4.5a.5.5 0 0 1-.5-.5h0a.5.5 0 0 1 1 0h0a.5.5 0 0 1-.5.5M4 8a.5.5 0 0 1-.5-.5h0a.5.5 0 0 1 1 0h0A.5.5 0 0 1 4 8m6.657-2.657a.5.5 0 0 1 .707-.707h0a.5.5 0 1 1-.707.707M4.636 11.364a.5.5 0 1 1 .707-.707h0a.5.5 0 0 1-.707.707m7.071 0a.5.5 0 0 1-.707-.707h0a.5.5 0 0 1 .707.707M5.343 5.343a.5.5 0 1 1-.707-.707h0a.5.5 0 0 1 .707.707M8 5a3 3 0 1 0 0 6 3 3 0 0 0 0-6"/></svg>';
      const moon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"/></svg>';
      const setIcon = (btn, mode) => {
        if (!btn) return;
        const icon = mode === 'dark' ? sun : moon;
        btn.innerHTML = icon;
        const label = mode === 'dark' ? 'Switch to light mode' : 'Switch to dark mode';
        btn.setAttribute('aria-label', label);
        btn.setAttribute('title', label);
      };
      const stored = localStorage.getItem('theme');
      if (stored === 'dark') body.classList.add('dark');
      const btnInit = document.getElementById(toggleBtnId);
      setIcon(btnInit, body.classList.contains('dark') ? 'dark' : 'light');
      document.addEventListener('click', (e) => {
        if (!(e.target instanceof Element)) return;
        const btn = e.target.closest(`#${toggleBtnId}`);
        if (!btn) return;
        body.classList.toggle('dark');
        const mode = body.classList.contains('dark') ? 'dark' : 'light';
        localStorage.setItem('theme', mode);
        setIcon(btn, mode);
      });
    })();
  </script>
  <script>
    (() => {
      const btn = document.getElementById('copyFormatted');
      if (!btn) return;
      btn.addEventListener('click', () => {
        const targetId = btn.getAttribute('data-target');
        const pre = document.getElementById(targetId);
        if (!pre) return;
        const text = pre.innerText || pre.textContent || '';
        const reset = (label) => {
          const span = btn.querySelector('.copy-label');
          if (span) span.textContent = label;
        };
        const setTempLabel = (label) => {
          reset(label);
          setTimeout(() => reset('Copy'), 1500);
        };
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(text).then(() => setTempLabel('Copied!')).catch(() => setTempLabel('Copy failed'));
        } else {
          setTempLabel('Unsupported');
        }
      });
    })();
  </script>
</body>
</html>
{{end}}
